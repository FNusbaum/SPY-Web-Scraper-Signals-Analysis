import ssl
import certifi
from urllib.request import urlopen, Request
from urllib.error import URLError, HTTPError
import gzip
from io import BytesIO
from bs4 import BeautifulSoup
import time
import csv
from datetime import date
import os
import os.path



if __name__ == '__main__':


	table1 = [['10:03:00', 534.09,'--','--','--','--'],
	['10:04:00', 534.2,'--','--','--','--'],
	['10:05:00', 534.09,'--','--','--','--'],
	['10:06:00', 534.18,'--','--','--','--'],
	['10:07:00', 534.24,'--','--','--','--'],
	['10:08:00', 534.26,'--','--','--','--'],
	['10:09:00', 534.26,'--','--','--','--'],
	['10:10:00', 534.06,'--','--','--','--'],
	['10:11:00', 534.04,'--','--','--','--'],
	['10:12:00', 534.05,'--','--','--','--'],
	['10:13:00', 534.27,'--','--','--','--'],
	['10:14:00', 534.26,'--','--','--','--'],
	['10:15:00', 534.15,'--','--','--','--'],
	['10:16:00', 534.35,'--','--','--','--'],
	['10:17:00', 534.51,'--','--','--','--'],
	['10:18:00', 534.57,'--','--','--','--'],
	['10:19:00', 534.63,'--','--','--','--'],
	['10:20:00', 534.54,'--','--','--','--'],
	['10:21:00', 534.6,'--','--','--','--'],
	['10:22:00', 534.56,'--','--','--','--'],
	['10:23:00', 534.6,'--','--','--','--'],
	['10:24:00', 534.61,'--','--','--','--'],
	['10:25:00', 534.63,'--','--','--','--'],
	['10:26:00', 534.58,'--','--','--','--'],
	['10:27:00', 534.56,'--','--','--','--'],
	['10:28:00', 534.67,'--','--','--','--'],
	['10:29:00', 534.64,'--','--','--','--'],
	['10:30:00', 534.6,'--','--','--','--'],
	['10:31:00', 534.57,'--','--','--','--'],
	['10:32:00', 534.59,'--','--','--','--'],
	['10:33:00', 534.43,'--','--','--','--'],
	['10:34:00', 534.59,'--','--','--','--'],
	['10:35:00', 534.67,'--','--','--','--'],
	['10:36:00', 534.76,'--','--','--','--'],
	['10:37:00', 535.1,'--','--','--','--'],
	['10:38:00', 535.14,'--','--','--','--'],
	['10:39:00', 535.46,'--','--','--','--'],
	['10:40:00', 535.8,'--','--','--','--'],
	['10:41:00', 535.81,'--','--','--','--'],
	['10:42:00', 535.97,'--','--','--','--'],
	['10:43:00', 535.86,'--','--','--','--'],
	['10:44:00', 535.97,'--','--','--','--'],
	['10:45:00', 535.96,'--','--','--','--'],
	['10:46:00', 536.16,'--','--','--','--'],
	['10:47:00', 536.28,'--','--','--','--'],
	['10:48:00',  536.35,'--','--','--','--'],
	['10:49:00', 536.17,'--','--','--','--'],
	['10:50:00', 536.01,'--','--','--','--'],
	['10:51:00', 535.93,'--','--','--','--'],
	['10:52:00',  535.73,'--','--','--','--'],
	['10:53:00', 535.8,'--','--','--','--'],
	['10:54:00', 535.84,'--','--','--','--'],
	['10:55:00',  535.67,'--','--','--','--'],
	['10:56:00',  535.49,'--','--','--','--'],
	['10:57:00', 535.42,'--','--','--','--'],
	['10:58:00', 535.41,'--','--','--','--'],
	['10:59:00', 535.3,'--','--','--','--'],
	['11:00:00', 534.82,'--','--','--','--'],
	['11:01:00', 534.88,'--','--','--','--'],
	['11:02:00', 534.96,'--','--','--','--'],
	['11:03:00', 534.88,'--','--','--','--'],
	['11:04:00', 534.74,'--','--','--','--'],
	['11:05:00', 534.66,'--','--','--','--'],
	['11:06:00', 534.44,'--','--','--','--'],
	['11:07:00', 534.27,'--','--','--','--'],
	['11:08:00', 534.39,'--','--','--','--'],
	['11:09:00', 534.36,'--','--','--','--'],
	['11:10:00', 534.25,'--','--','--','--'],
	['11:11:00', 534.22,'--','--','--','--'],
	['11:12:00', 534.3,'--','--','--','--'],
	['11:13:00', 534.35,'--','--','--','--'],
	['11:14:00', 534.51,'--','--','--','--'],
	['11:15:00', 534.47,'--','--','--','--'],
	['11:16:00', 534.31,'--','--','--','--'],
	['11:17:00', 534.33,'--','--','--','--'],
	['11:18:00', 534.38,'--','--','--','--'],
	['11:19:00', 534.3,'--','--','--','--'],
	['11:20:00', 534.33,'--','--','--','--'],
	['11:21:00', 534.33,'--','--','--','--'],
	['11:22:00', 534.53,'--','--','--','--'],
	['11:23:00', 534.74,'--','--','--','--'],
	['11:24:00', 534.91,'--','--','--','--'],
	['11:25:00', 534.91,'--','--','--','--'],
	['11:26:00', 534.96,'--','--','--','--'],
	['11:27:00', 534.85,'--','--','--','--'],
	['11:28:00', 534.73,'--','--','--','--'],
	['11:29:00', 534.95,'--','--','--','--']]


	table2 = [['11:40:00', 535.03,'--','--','--','--'],
	['11:41:00', 534.99,'--','--','--','--'],
	['11:42:00', 534.81,'--','--','--','--'],
	['11:43:00', 534.79,'--','--','--','--'],
	['11:44:00', 534.79,'--','--','--','--'],
	['11:45:00', 534.82,'--','--','--','--'],
	['11:46:00', 534.86,'--','--','--','--'],
	['11:47:00', 534.96,'--','--','--','--'],
	['11:48:00', 535.11,'--','--','--','--']]

	file_path = '2024-06-07/2024-06-07_SPY.csv'
	with open(file_path, 'r') as file:
		reader = csv.reader(file, dialect = 'excel')
		prices = list(reader)
		file.close()
	newTable = []

	for i in range(len(prices)):
		if i == 34:
			newTable+=table1
		if i == 44:
			newTable+=table2
		newTable += [prices[i]]

	with open(file_path, 'w') as file:
		writer = csv.writer(file, dialect = 'excel')
		writer.writerows(newTable)
		file.close












